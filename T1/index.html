<html>
<header>
    <title>Calculadora de consumo energético</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <style>
        /* Remove setas de campos numéricos */
        /* Chrome, Safari, Edge, Opera */
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
          -webkit-appearance: none;
          margin: 0;
        }
        
        /* Firefox */
        input[type=number] {
          -moz-appearance: textfield;
        }
    </style>
</header>

<body>
<select name="mode" id="calculator_mode">
    <option disabled selected value> -- selecione um modo -- </option>
    <option value="mode_1">Modo 1</option>
    <option value="mode_2">Modo 2</option>
    <option value="mode_3">Modo 3</option>
</select>
<div id='calculator'>
</div>
<script>
    $("#calculator_mode").prop("selectedIndex", 0);
    $('#calculator_mode').change(function () {
        let selected_mode = $(this).val()
        switch (selected_mode) {
            case 'mode_1':
                load_calc_mode1()
                break;
            case 'mode_2':
                load_calc_mode2()
                break;
            case 'mode_3':
                load_calc_mode3()
                break;
            default:
                alert(selected_mode + " not implemented")
        }
    })

    function load_calc_mode1() {
        let calc_mode1 = `
    Potência: <input type="number" id="power"> mW<br/>
    Ciclos: <input type="number" id="cycles"><br/>
    Frequência: <input type="number" id="frequency"> MHz<br/>
    Energia: <span id="energy"></span> J
    `
    function print_energy() {
        let energy = $('#power').val() * $('#cycles').val() / $('#frequency').val()
        $('#energy').text(energy)
    }

    $('#calculator').html(calc_mode1)
    $('#calculator').on('change', '#power, #cycles, #frequency', print_energy)
    print_energy()
    }

    var calc_mode23 = `
        Resistências, separadas por espaços: <input type="test" id="resistences"> &#x2126;<br/>
        Tensão: <input type="number" id="voltage"> V<br/>
        Tempo de operação: <input type="number" id="time"> s<br/>
        Resistência equivalente: <span id="equivalent_resistance"></span> &#x2126;<br/>
        Corrente: <span id="current"></span> A<br/>
        Potência: <span id="power"></span> W<br/>
        Energia: <span id="energy"></span> J
        `

    function print_calculations(equivalent_resistence) {
        $('#equivalent_resistance').text(equivalent_resistence)
        let current = $('#voltage').val() / equivalent_resistence
        let power = $('#voltage').val() * current
        let energy = power * $('#time').val()
        $('#current').text(current)
        $('#power').text(power)
        $('#energy').text(energy)
    }

    function load_calc_mode2() {
        function print_mode2_calculations() {
            let equivalent_resistence = 0
            $('#resistences').val().split(' ').forEach(resistence => {
                equivalent_resistence += Number(resistence)
            });
            print_calculations(equivalent_resistence)
        }

        $('#calculator').html(calc_mode23)
        $('#calculator').on('change', '#resistences, #voltage, #time', print_mode2_calculations)
        print_mode2_calculations()
    }

    function load_calc_mode3() {
        function print_mode3_calculations() {
            let conductance = 0
            $('#resistences').val().split(' ').forEach(resistence => {
                conductance += 1 / Number(resistence)
            });
            equivalent_resistence = 1 / conductance
            print_calculations(equivalent_resistence)
        }

        $('#calculator').html(calc_mode23)
        $('#calculator').on('change', '#resistences, #voltage, #time', print_mode3_calculations)
        print_mode3_calculations()
    }

</script>
</body>
</html>
